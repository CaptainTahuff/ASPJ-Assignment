{% extends "base.html" %}
{% block title %}CB Shop{% endblock %}

{% block SearchBar %}
<ul class="navbar-nav w-100 justify-content-center">
    <li class="nav-item active">
        <form class="form-inline my-2 my-lg-0" action="">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
    </li>
</ul>
{% endblock %}

{% block style %}
<style>
div.item-container{
    margin: 20px 20px;
    padding: 20px 0px 40px 52.5px;
    border: 1px #c2c2c238 solid;
    border-radius: 5px;
    background-color: WhiteSmoke;
}

div.item-container-active{
    margin: 20px 20px;
    padding: 20px 0px 40px 52.5px;
    border: 1px #c2c2c238 solid;
    border-radius: 5px;
    background-color: #7d7d7d;
    transform: scale(1.05);
}

span.item-name{
    font-weight: bold;
    word-wrap: break-word;
    width: 150px
}

span.item-price{

}

div.overlay{
    position: fixed;
    display: none;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0,0,0,0.5);
    z-index: 2;
}

div.overlay-item{
    position: absolute;
    top: 50%;
    left: 50%;
    color: black;
    background-color: LightGrey;
    border: 1px black solid;
    border-radius: 15px;
    padding: 5%;
    transform: translate(-50%,-50%);
    -ms-transform: translate(-50%,-50%);
}

img.item-image-mini{
    height: 150px;
    width: 150px;
}

img#item-image{
    display:inline-block;
    vertical-align: middle;
}

div#item-details{
    display:inline-block;
    vertical-align: middle;
}

div#item-details > span{
    margin: 5px 0px;
}
</style>
{% endblock %}

{% block content %}
<div class="row">
<div class="col col-1"></div>
{% for i in range(length) %}
    <div class="col col-2 item-container" id="{{ products[i][0] }}">
        {% if products[i][2] is none %}
        <img src="../static/img/None.png" class="item-image-mini">
        {% else %}
        <img src="../static/img/{{ products[i][2] }}" class="item-image-mini">
        {% endif %}
        <br>
        <span class="item-name">{{ products[i][0] }}</span>
        <br>
        <span class="item-price">Price: {{ "${:.2f}".format(products[i][1]) }}</span>
    </div>

    {% if (i+1) % 4 == 0 and i != 0 %}
    </div>
    <div class="row">
    <div class="col col-1"></div>
    {% endif %}

{% endfor %}
</div>

<div class="overlay">
    <div class="overlay-item">
        <img src="" id="item-image">
            <div id="item-details"></div>
        <hr>
        <span>Description:</span>
        <p id="item-desc"></p>
        <button class="btn btn-primary">Add To Cart</button>
    </div>
</div>
{% endblock %}

{% block function %}
<script src="../static/js/Shop.js"></script>
<script>
var data = CreateList()
$(document).ready(function(){
    // "pop up" item when mouse enters the box
    $('.item-container').on('mouseenter', function(){
        $(this).addClass('item-container-active');
    });

    // revert item when mouse leaves the box
    $('.item-container').on('mouseleave', function(){
        $(this).removeClass('item-container-active');
    });

    // show overlay when item is clicked
    $(".item-container").on('click', function(){
        var item = $(this).attr('id');
        $(".overlay").show();
        for (product in data){
            if (data[product][0] == item){
                $("#item-details").html('<span>' + data[product][0] + '</span><br><span>' + data[product][1] + '</span><br><span>Price: $' + data[product][2].toFixed(2) + "</span>");
                $("#item-desc").text(data[product][3]);
                if (data[product][4] != null){
                    $("#item-image").attr('src', '../static/img/' + data[product][4]);
                }
                else{
                    $("#item-image").attr('src', '../static/img/None.png');
                }
            };
        };
    });

    // hide overlay when overlay is clicked
    $(".overlay").on('click', function(){
        $(".overlay").hide();
        $("#item-name").text('');
    });

})
</script>
{% endblock %}